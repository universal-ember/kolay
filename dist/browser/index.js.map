{"version":3,"file":"index.js","sources":["../../src/browser/components/logs.gjs"],"sourcesContent":["import { template } from \"@ember/template-compiler\";\nimport Component from '@glimmer/component';\nimport { TrackedArray } from 'tracked-built-ins';\nimport { registerDestructor } from '@ember/destroyable';\nconst originalLog = console.log;\nconst LEVELS = [\n    'log',\n    'warn',\n    'error',\n    'debug',\n    'info'\n];\nexport class Logs extends Component {\n    logs = new TrackedArray();\n    constructor(...args1){\n        super(...args1);\n        registerDestructor(this, ()=>console.log = originalLog);\n        for (let level1 of LEVELS){\n            console[level1] = (...messageParts1)=>this.logs.push({\n                    level: level1,\n                    message: messageParts1.join(' '),\n                    timestamp: new Date()\n                });\n            originalLog[level1](...messageParts);\n        }\n    }\n    static{\n        template(`\n    <div class=\"kolay__in-viewport__logs\">\n      <LogList @logs={{this.logs}} />\n    </div>\n    <style>\n      .kolay__in-viewport__logs {\n        position: fixed;\n        bottom: 0;\n        left: 0;\n        right: 0;\n        padding: 0.5rem;\n        border: 1px solid gray;\n      }\n    </style>\n  `, {\n            component: this,\n            eval () {\n                return eval(arguments[0]);\n            }\n        });\n    }\n}\nlet frame;\nfunction scrollToBottom() {\n    if (frame) {\n        cancelAnimationFrame(frame);\n    }\n    frame = requestAnimationFrame(()=>{\n        let el1 = document.querySelector('.kolay__log-list__scroll');\n        el1.scrollTo({\n            top: el1.scrollHeight,\n            left: 0,\n            behavior: 'smooth'\n        });\n    });\n}\nlet formatter = new Intl.DateTimeFormat('en-GB', {\n    hour: \"numeric\",\n    minute: \"numeric\",\n    second: \"numeric\",\n    fractionalSecondDigits: 2\n});\nconst format = (date1)=>formatter.format(date1);\nconst LogList = template(`\n  <div class=\"kolay__log-list__scroll\">\n    {{#each logs as |logEntry|}}\n      <div class=\"kolay__log-list__level {{logEntry.level}}\">\n        <span class=\"kolay__log-list__time\">{{format logEntry.timestamp}}</span>\n        <span>{{logEntry.message}}</span>\n      </div>\n      {{ (scrollToBottom) }}\n    {{/each}}  \n  </div>\n\n  <style>\n    .kolay__log-list__scroll {\n      position: relative;\n      overflow: auto;\n      max-height: 10rem;\n\n      .kolay__log-list__level {\n        display: flex;\n        gap: 0.5rem;\n      }\n\n      .kolay__log-list__time {\n        border-right: 1px solid;\n        padding-right: 0.5rem;\n      }\n    }\n  </style>\n`, {\n    eval () {\n        return eval(arguments[0]);\n    }\n});\n"],"names":["originalLog","console","log","LEVELS","Logs","Component","logs","TrackedArray","constructor","args1","registerDestructor","level1","messageParts1","push","level","message","join","timestamp","Date","messageParts","setComponentTemplate","precompileTemplate","scope","LogList","strictMode","frame","scrollToBottom","cancelAnimationFrame","requestAnimationFrame","el1","document","querySelector","scrollTo","top","scrollHeight","left","behavior","formatter","Intl","DateTimeFormat","hour","minute","second","fractionalSecondDigits","format","date1","templateOnly"],"mappings":";;;;;;;AAIA,MAAMA,WAAW,GAAGC,OAAO,CAACC,GAAG,CAAA;AAC/B,MAAMC,MAAM,GAAG,CACX,KAAK,EACL,MAAM,EACN,OAAO,EACP,OAAO,EACP,MAAM,CACT,CAAA;AACM,MAAMC,IAAI,SAASC,SAAS,CAAC;AAChCC,EAAAA,IAAI,GAAG,IAAIC,YAAY,EAAE,CAAA;EACzBC,WAAWA,CAAC,GAAGC,KAAK,EAAC;IACjB,KAAK,CAAC,GAAGA,KAAK,CAAC,CAAA;IACfC,kBAAkB,CAAC,IAAI,EAAE,MAAIT,OAAO,CAACC,GAAG,GAAGF,WAAW,CAAC,CAAA;AACvD,IAAA,KAAK,IAAIW,MAAM,IAAIR,MAAM,EAAC;AACtBF,MAAAA,OAAO,CAACU,MAAM,CAAC,GAAG,CAAC,GAAGC,aAAa,KAAG,IAAI,CAACN,IAAI,CAACO,IAAI,CAAC;AAC7CC,QAAAA,KAAK,EAAEH,MAAM;AACbI,QAAAA,OAAO,EAAEH,aAAa,CAACI,IAAI,CAAC,GAAG,CAAC;QAChCC,SAAS,EAAE,IAAIC,IAAI,EAAC;AACxB,OAAC,CAAC,CAAA;AACNlB,MAAAA,WAAW,CAACW,MAAM,CAAC,CAAC,GAAGQ,YAAY,CAAC,CAAA;AACxC,KAAA;AACJ,GAAA;AACA,EAAA;IACIC,oBAAA,CAAAC,kBAAA,CAcH,4TAAA,EAAA;AAAAC,MAAAA,KAAA,EAAAA,OAAA;AAAAC,QAAAA,OAAAA;AAAA,OAAA,CAAA;MAAAC,UAAA,EAAA,IAAA;KAKI,CAAC,EAJa,IAAI,CAAA,CAAA;AAKvB,GAAA;AACJ,CAAA;AACA,IAAIC,KAAK,CAAA;AACT,SAASC,cAAcA,GAAG;AACtB,EAAA,IAAID,KAAK,EAAE;IACPE,oBAAoB,CAACF,KAAK,CAAC,CAAA;AAC/B,GAAA;EACAA,KAAK,GAAGG,qBAAqB,CAAC,MAAI;AAC9B,IAAA,IAAIC,GAAG,GAAGC,QAAQ,CAACC,aAAa,CAAC,0BAA0B,CAAC,CAAA;IAC5DF,GAAG,CAACG,QAAQ,CAAC;MACTC,GAAG,EAAEJ,GAAG,CAACK,YAAY;AACrBC,MAAAA,IAAI,EAAE,CAAC;AACPC,MAAAA,QAAQ,EAAE,QAAA;AACd,KAAC,CAAC,CAAA;AACN,GAAC,CAAC,CAAA;AACN,CAAA;AACA,IAAIC,SAAS,GAAG,IAAIC,IAAI,CAACC,cAAc,CAAC,OAAO,EAAE;AAC7CC,EAAAA,IAAI,EAAE,SAAS;AACfC,EAAAA,MAAM,EAAE,SAAS;AACjBC,EAAAA,MAAM,EAAE,SAAS;AACjBC,EAAAA,sBAAsB,EAAE,CAAA;AAC5B,CAAC,CAAC,CAAA;AACF,MAAMC,MAAM,GAAIC,KAAK,IAAGR,SAAS,CAACO,MAAM,CAACC,KAAK,CAAC,CAAA;AAC/C,MAAMtB,OAAO,GAAAH,oBAAA,CAAGC,kBAAA,CA4Bb,yqBAAA,EAAA;AAAAC,EAAAA,KAAA,EAAAA,OAAA;IAAAhB,IAAA;IAAAsC,MAAA;AAAAlB,IAAAA,cAAAA;AAAA,GAAA,CAAA;EAAAF,UAAA,EAAA,IAAA;AAIH,CAAC,CAAC,EAAAsB,YAAA,EAAA,CAAA;;;;"}
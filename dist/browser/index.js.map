{"version":3,"file":"index.js","sources":["../../src/browser/router.ts"],"sourcesContent":["import { assert } from '@ember/debug';\nimport { getOwner } from '@ember/owner';\n\nimport { docsManager } from './services/docs.ts';\n\nimport type { RouterDSL } from '@ember/-internals/routing';\nimport type Transition from '@ember/routing/transition';\n\nexport function addRoutes(context: Pick<RouterDSL, 'route'>): void {\n  /**\n   * We need a level of nesting for every `/` in the URL so that we don't over-refresh / render the whole page\n   */\n  context.route('page', { path: '/*page' }, function () {});\n}\n\n/**\n * Does our target destination exist? if not,\n * redirect to the first page on the namespace\n *\n * For use with addRoutes(), which defines a \"page\" path matcher\n */\nexport function handlePotentialIndexVisit(context: object, transition: Transition) {\n  const docs = docsManager(context);\n\n  if (transition.to?.localName !== 'index') return;\n\n  const groupName = String(transition.to.parent?.params?.page);\n\n  if (!groupName) return;\n  if (!docs.availableGroups.includes(groupName)) return;\n\n  const group = docs.groupFor(groupName);\n\n  const first = group.list[0];\n\n  if (!first) {\n    console.warn(`Could not determine first page in group: ${groupName}`);\n\n    return;\n  }\n\n  const router = getOwner(context)?.lookup('service:router');\n\n  assert(`Expected to find the router service, but did not`, router);\n\n  router.transitionTo(first.path);\n}\n"],"names":["addRoutes","context","route","path","handlePotentialIndexVisit","transition","docs","docsManager","to","localName","groupName","String","parent","params","page","availableGroups","includes","group","groupFor","first","list","console","warn","router","getOwner","lookup","assert","transitionTo"],"mappings":";;;;;;;AAQO,SAASA,SAASA,CAACC,OAAiC,EAAQ;AACjE;AACF;AACA;AACEA,EAAAA,OAAO,CAACC,KAAK,CAAC,MAAM,EAAE;AAAEC,IAAAA,IAAI,EAAE;AAAS,GAAC,EAAE,YAAY,CAAC,CAAC,CAAC;AAC3D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACO,SAASC,yBAAyBA,CAACH,OAAe,EAAEI,UAAsB,EAAE;AACjF,EAAA,MAAMC,IAAI,GAAGC,WAAW,CAAQ,CAAC;AAEjC,EAAA,IAAIF,UAAU,CAACG,EAAE,EAAEC,SAAS,KAAK,OAAO,EAAE;AAE1C,EAAA,MAAMC,SAAS,GAAGC,MAAM,CAACN,UAAU,CAACG,EAAE,CAACI,MAAM,EAAEC,MAAM,EAAEC,IAAI,CAAC;EAE5D,IAAI,CAACJ,SAAS,EAAE;EAChB,IAAI,CAACJ,IAAI,CAACS,eAAe,CAACC,QAAQ,CAACN,SAAS,CAAC,EAAE;AAE/C,EAAA,MAAMO,KAAK,GAAGX,IAAI,CAACY,QAAQ,CAACR,SAAS,CAAC;AAEtC,EAAA,MAAMS,KAAK,GAAGF,KAAK,CAACG,IAAI,CAAC,CAAC,CAAC;EAE3B,IAAI,CAACD,KAAK,EAAE;AACVE,IAAAA,OAAO,CAACC,IAAI,CAAC,CAAA,yCAAA,EAA4CZ,SAAS,EAAE,CAAC;AAErE,IAAA;AACF,EAAA;EAEA,MAAMa,MAAM,GAAGC,QAAQ,CAACvB,OAAO,CAAC,EAAEwB,MAAM,CAAC,gBAAgB,CAAC;AAE1DC,EAAAA,MAAM,CAAC,CAAA,gDAAA,CAAkD,EAAEH,MAAM,CAAC;AAElEA,EAAAA,MAAM,CAACI,YAAY,CAACR,KAAK,CAAChB,IAAI,CAAC;AACjC;;;;"}
{
  "$schema": "https://turbo.build/schema.json",
  // Required, because the root is a workspace
  "extends": ["//"],
  // Additive to package.json and turbo.json
  //
  // https://turbo.build/repo/docs/core-concepts/caching/file-inputs#specifying-additional-inputs
  "globalDependencies": [
    "pnpm-lock.yaml",
    "patches",
    ".github/workflows/ci.yml",
    ".github/workflows/release.yml",
    ".github/workflows/push-dish.yml",
    ".github/workflows/deploy-preview.yml"
  ],
  "tasks": {
    /////////////////////////////////////////////////
    /////////////////////////////////////////////////
    //
    //         Local Dev
    //
    /////////////////////////////////////////////////
    /////////////////////////////////////////////////
    "dev": {
      "dependsOn": ["^dev"],
      "cache": false
    },
    "sync": {
      "dependsOn": ["^build"],
      "cache": false
    },

    "start": {
      "dependsOn": ["^build", "sync"],
      "outputs": [],
      "cache": false,
      "persistent": true
    },

    /////////////////////////////////////////////////
    /////////////////////////////////////////////////
    //
    //         C.I. / C.D.
    //
    /////////////////////////////////////////////////
    /////////////////////////////////////////////////
    "build": {
      "outputs": ["dist/**", "declarations/**"],
      "dependsOn": ["^build", "sync"]
    },
    "build:app": {
      "outputs": ["dist/**"],
      "dependsOn": ["^build", "sync"]
    },
    "test:node": {
      "outputs": [],
      "dependsOn": ["^build", "sync"]
    },
    "test:ember": {
      "env": ["CI_BROWSER", "EMBER_TRY_CURRENT_SCENARIO", "EMBROIDER_TEST_SETUP_OPTIONS"],
      "dependsOn": ["^build", "sync"]
    },

    /////////////////////////////////////////////////
    /////////////////////////////////////////////////
    //
    //         Quality Checks
    //
    /////////////////////////////////////////////////
    /////////////////////////////////////////////////
    "_:lint": {
      "outputs": [],
      "dependsOn": [
        "lint:js",
        "lint:hbs",
        "lint:prettier",
        "lint:types",
        "lint:package",
        "lint:published-types"
      ]
    },
    "lint:eslint": { "outputs": [], "dependsOn": ["^build", "sync"] },
    "lint:js": { "outputs": [], "dependsOn": ["^build", "sync"] },
    "lint:hbs": { "outputs": [] },
    "lint:prettier": { "outputs": [] },
    "lint:types": { "outputs": [], "dependsOn": ["^build", "sync"] },
    "lint:package": { "outputs": [], "dependsOn": ["build"] },
    "lint:published-types": { "outputs": [], "dependsOn": ["build"] },

    "_:lint:fix": {
      "cache": false,
      "dependsOn": ["lint:js:fix", "lint:eslint:fix", "lint:prettier:fix", "lint:hbs:fix", "format"]
    },
    // Prettier can alter files too, so let's prevent race conditions for multiple
    // writing to the same files.
    "lint:js:fix": { "cache": false, "dependsOn": ["^build", "sync"] },
    "lint:eslint:fix": { "cache": false },
    "lint:hbs:fix": { "cache": false },
    "lint:prettier:fix": {
      "cache": false,
      "dependsOn": ["lint:js:fix", "lint:hbs:fix", "lint:eslint:fix"]
    },
    "format": { "cache": false, "dependsOn": ["lint:js:fix", "lint:hbs:fix", "lint:eslint:fix"] }
  }
}
